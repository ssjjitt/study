use univer;
-- Вставка данных в таблицу FACULTY
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F01', 'Факультет компьютерных наук');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F02', 'Факультет экономики');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F03', 'Факультет права');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F04', 'Факультет инженерии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F05', 'Факультет биологии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F06', 'Факультет химии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F07', 'Факультет физики');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F08', 'Факультет математики');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F09', 'Факультет истории');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F10', 'Факультет философии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F11', 'Факультет искусств');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F12', 'Факультет иностранных языков');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F13', 'Факультет медицины');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F14', 'Факультет педагогики');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F15', 'Факультет социологии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F16', 'Факультет управления');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F17', 'Факультет журналистики');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F18', 'Факультет экологии');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F19', 'Факультет сельского хозяйства');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F20', 'Факультет уголовного права');

-- Вставка данных в таблицу PROFESSION
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P01', 'F01', 'Программист', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P02', 'F01', 'Системный аналитик', 'Бакалавр', 'P01');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P03', 'F02', 'Экономист', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P04', 'F03', 'Юрист', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P05', 'F01', 'Инженер-программист', 'Магистр', 'P01');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P06', 'F02', 'Финансист', 'Бакалавр', 'P03');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P07', 'F03', 'Адвокат', 'Магистр', 'P04');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P08', 'F04', 'Инженер', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P09', 'F04', 'Архитектор', 'Магистр', 'P08');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P10', 'F05', 'Биолог', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P11', 'F06', 'Химик', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P12', 'F07', 'Физик', 'Магистр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P13', 'F08', 'Математик', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P14', 'F09', 'Историк', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P15', 'F10', 'Философ', 'Магистр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P16', 'F11', 'Художник', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P17', 'F12', 'Переводчик', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P18', 'F13', 'Врач', 'Магистр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P19', 'F14', 'Учитель', 'Бакалавр', NULL);
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION, PARENT_PROFESSION) VALUES ('P20', 'F15', 'Социолог', 'Бакалавр', NULL);

-- Вставка данных в таблицу PULPIT
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P01', 'Кафедра программирования', 'F01');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P02', 'Кафедра экономики', 'F02');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P03', 'Кафедра права', 'F03');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P04', 'Кафедра инженерии', 'F04');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P05', 'Кафедра биологии', 'F05');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P06', 'Кафедра химии', 'F06');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P07', 'Кафедра физики', 'F07');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P08', 'Кафедра математики', 'F08');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P09', 'Кафедра истории', 'F09');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P10', 'Кафедра философии', 'F10');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P11', 'Кафедра искусств', 'F11');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P12', 'Кафедра иностранных языков', 'F12');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P13', 'Кафедра медицины', 'F13');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P14', 'Кафедра педагогики', 'F14');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P15', 'Кафедра социологии', 'F15');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P16', 'Кафедра управления', 'F16');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P17', 'Кафедра журналистики', 'F17');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P18', 'Кафедра экологии', 'F18');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P19', 'Кафедра сельского хозяйства', 'F19');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P20', 'Кафедра уголовного права', 'F20');

-- Вставка данных в таблицу TEACHER
 INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T01', 'Иван', 'Иванов', 'Иванович', 'м', '2010-09-01', 40.0, 'P01');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T02', 'Мария', 'Петрова', 'Сергеевна', 'ж', '2015-09-01', 40.0, 'P02');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T03', 'Олег', 'Сидоров', 'Александрович', 'м', '2018-09-01', 40.0, 'P03');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T04', 'Андрей', 'Сидорович', 'Александрович', 'м', '2008-09-11', 40.0, 'P03');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T05', 'Елена', 'Лаврова', 'Николаевна', 'ж', '2016-03-15', 40.0, 'P01');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T06', 'Игорь', 'Михайлов', 'Иванович', 'м', '2012-08-01', 40.0, 'P02');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T07', 'Светлана', 'Кузнецова', 'Петровна', 'ж', '2017-01-10', 40.0, 'P03');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T08', 'Дмитрий', 'Сергеев', 'Александрович', 'м', '2013-11-21', 40.0, 'P01');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T09', 'Татьяна', 'Романова', 'Станиславовна', 'ж', '2019-06-30', 40.0, 'P02');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) 
VALUES ('T10', 'Александр', 'Федоров', 'Викторович', 'м', '2020-02-15', 40.0, 'P03');


-- Вставка данных в таблицу SUBJECT
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S01', 'Программирование', 'T01');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S02', 'Экономика', 'T02');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S03', 'Право', 'T03');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S04', 'Методы анализа', 'T04');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S05', 'Статистика', 'T05');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S06', 'Операционные системы', 'T06');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S07', 'Финансовый учет', 'T07');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S08', 'Гражданское право', 'T08');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S09', 'Алгоритмы', 'T09');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S10', 'Клиент-серверные технологии', 'T10');

-- Вставка данных в таблицу GROUPS
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F01', 'P01', 2021);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F02', 'P03', 2022);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F03', 'P04', 2023);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F01', 'P02', 2021);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F02', 'P01', 2022);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F03', 'P03', 2023);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F01', 'P03', 2021);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F02', 'P02', 2022);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F03', 'P01', 2023);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F04', 'P04', 2024);

-- Вставка данных в таблицу STUDENT
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (1, 'Алексей', 'Ковалев', 'Викторович', CAST('2000-05-15' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (1, 'Анна', 'Смирнова', 'Дмитриевна', CAST('2001-10-20' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (2, 'Ирина', 'Федорова', 'Александровна', CAST('2002-02-05' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (2, 'Дмитрий', 'Сергеев', 'Александрович', CAST('2001-12-15' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (3, 'Петр', 'Иванов', 'Сидорович', CAST('2003-04-10' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (3, 'Светлана', 'Лаврова', 'Николаевна', CAST('2000-07-08' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (1, 'Мария', 'Кузнецова', 'Петровна', CAST('2002-03-12' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (2, 'Николай', 'Семенов', 'Васильевич', CAST('2000-11-25' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (3, 'Владимир', 'Григорьев', 'Станиславович', CAST('2001-01-30' AS DATE));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (2, 'Татьяна', 'Ковалева', 'Игоревна', CAST('2002-09-21' AS DATE));
 
-- Вставка данных в таблицу PROGRESS
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 1, CAST('2023-06-15' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 2, CAST('2023-06-15' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S02', 3, CAST('2023-06-15' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S03', 1, CAST('2023-06-16' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S04', 2, CAST('2023-06-16' AS DATE), 6);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S05', 3, CAST('2023-06-16' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S06', 1, CAST('2023-06-17' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S07', 2, CAST('2023-06-17' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S08', 3, CAST('2023-06-17' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S09', 1, CAST('2023-06-18' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 2, CAST('2023-06-18' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 3, CAST('2023-06-18' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S02', 1, CAST('2023-06-19' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S03', 2, CAST('2023-06-19' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S04', 3, CAST('2023-06-19' AS DATE), 6);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S05', 1, CAST('2023-06-20' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S06', 2, CAST('2023-06-20' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S07', 3, CAST('2023-06-20' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S08', 1, CAST('2023-06-21' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S09', 2, CAST('2023-06-21' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 3, CAST('2023-06-21' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 1, CAST('2023-06-25' AS DATE), 5);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S02', 2, CAST('2023-06-25' AS DATE), 6);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S03', 3, CAST('2023-06-25' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S04', 1, CAST('2023-06-26' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S05', 2, CAST('2023-06-26' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S06', 3, CAST('2023-06-26' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S07', 1, CAST('2023-06-27' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S08', 2, CAST('2023-06-27' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S09', 3, CAST('2023-06-27' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 1, CAST('2023-06-28' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 2, CAST('2023-06-28' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S02', 3, CAST('2023-06-28' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S03', 1, CAST('2023-06-29' AS DATE), 6);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S04', 2, CAST('2023-06-29' AS DATE), 7);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S05', 3, CAST('2023-06-29' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S06', 1, CAST('2023-06-30' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S07', 2, CAST('2023-06-30' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S08', 3, CAST('2023-06-30' AS DATE), 10);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S09', 1, CAST('2023-07-01' AS DATE), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 2, CAST('2023-07-01' AS DATE), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 3, CAST('2023-07-01' AS DATE), 1);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S10', 3, CAST('2023-07-01' AS DATE), 2);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S06', 2, CAST('2023-07-01' AS DATE), 3);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S09', 2, CAST('2023-07-01' AS DATE), 8);

select * from FACULTY;
select * from PROFESSION;
select * from PULPIT;
select * from TEACHER;
select * from SUBJECT;
select * from GROUPS;
select * from STUDENT;
select * from PROGRESS;

--Вычисление средней успеваемости студентов помесячно, 
--за квартал, за полгода, за год.

WITH Monthly_Averages AS (
    SELECT
        YEAR(PDATE) AS year,
        MONTH(PDATE) AS month,
        AVG(CAST(ESTIMATION AS FLOAT)) AS average_score
    FROM
        PROGRESS
    GROUP BY
        YEAR(PDATE), MONTH(PDATE)
),
Quarterly_Averages AS (
    SELECT
        year,
        (MONTH - 1) / 3 + 1 AS quarter,
        AVG(average_score) AS average_score
    FROM
        Monthly_Averages
    GROUP BY
        year, (MONTH - 1) / 3 + 1
),
HalfYearly_Averages AS (
    SELECT
        year,
        CASE
            WHEN quarter IN (1, 2) THEN 1
            WHEN quarter IN (3, 4) THEN 2
        END AS half_year,
        AVG(average_score) AS average_score
    FROM
        Quarterly_Averages
    GROUP BY
        year, CASE
            WHEN quarter IN (1, 2) THEN 1
            WHEN quarter IN (3, 4) THEN 2
        END
),
Yearly_Averages AS (
    SELECT
        year,
        AVG(average_score) AS average_score
    FROM
        Monthly_Averages
    GROUP BY
        year
)
SELECT
    'помесячно' AS period, year, month, average_score FROM Monthly_Averages
UNION ALL
SELECT
    'за квартал' AS period, year, quarter, average_score FROM Quarterly_Averages
UNION ALL
SELECT
    'за полгода' AS period, year, half_year, average_score FROM HalfYearly_Averages
UNION ALL
SELECT
    'за год' AS period, year, NULL AS month, AVG(average_score) AS average_score
FROM
    Yearly_Averages
GROUP BY
    year
ORDER BY
    year, month;


--Вычисление средней успеваемости студентов за определенный период:
--•	средний балл;
--•	сравнение среднего балла со средним баллом по факультету (в %);
--•	сравнение среднего балла с наилучшим баллом (в %).


WITH Student_Averages AS (
    SELECT
        IDSTUDENT,
        AVG(CAST(ESTIMATION AS FLOAT)) AS average_score
    FROM
        PROGRESS
    WHERE
        PDATE BETWEEN '2023-01-01' AND '2023-12-31' 
    GROUP BY
        IDSTUDENT
),
Faculty_Average AS (
    SELECT
        AVG(average_score) AS faculty_average
    FROM
        Student_Averages
),
Best_Score AS (
    SELECT
        MAX(ESTIMATION) AS best_score
    FROM
        PROGRESS
)

SELECT
    sa.IDSTUDENT,
    sa.average_score,
    fa.faculty_average,
    (sa.average_score / fa.faculty_average) * 100 AS percentage_of_faculty_average,
    (sa.average_score / bs.best_score) * 100 AS percentage_of_best_score
FROM
    Student_Averages sa
CROSS JOIN
    Faculty_Average fa
CROSS JOIN
    Best_Score bs;

--Продемонстрируйте применение функции ранжирования ROW_NUMBER() для разбиения результатов запроса на страницы (по 20 строк на каждую страницу).
WITH RankedResults AS (
    SELECT 
        IDSTUDENT,
        ESTIMATION,
        ROW_NUMBER() OVER (ORDER BY ESTIMATION DESC) AS RowNum
    FROM 
        PROGRESS
)
SELECT *
FROM RankedResults
WHERE RowNum BETWEEN 1 AND 20; 

--Продемонстрируйте применение функции ранжирования ROW_NUMBER() для удаления дубликатов.
select * from progress;

WITH Duplicates AS (
    SELECT 
        IDSTUDENT,
        ESTIMATION,
        ROW_NUMBER() OVER (PARTITION BY ESTIMATION ORDER BY IDSTUDENT) AS RowNum
    FROM 
        PROGRESS
)
DELETE FROM Duplicates
WHERE RowNum > 1;

--Вернуть для каждого студента средние баллы по трем предметам, которые изучались последними.
WITH RankedSubjects AS (
    SELECT
        IDSTUDENT,
        SUBJECT,
        ESTIMATION,
        ROW_NUMBER() OVER (PARTITION BY IDSTUDENT ORDER BY PDATE DESC) AS RowNum
    FROM
        PROGRESS
)

SELECT
    IDSTUDENT,
    AVG(ESTIMATION) AS AverageScore
FROM
    RankedSubjects
WHERE
    RowNum <= 3
GROUP BY
    IDSTUDENT;
--Какой студент сдавал экзамен наибольшее число раз по определенному предмету? Вернуть для всех предметов.
WITH ExamCounts AS (
    SELECT 
        IDSTUDENT,
        SUBJECT,
        COUNT(*) AS ExamCount
    FROM 
        PROGRESS
    GROUP BY 
        IDSTUDENT, SUBJECT
),

RankedExams AS (
    SELECT 
        IDSTUDENT,
        SUBJECT,
        ExamCount,
        RANK() OVER (PARTITION BY SUBJECT ORDER BY ExamCount DESC) AS RankNum
    FROM 
        ExamCounts
)

SELECT 
    IDSTUDENT,
    SUBJECT,
    ExamCount
FROM 
    RankedExams
WHERE 
    RankNum = 1; 