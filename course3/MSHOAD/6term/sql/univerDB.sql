DROP TABLE FACULTY;
DROP TABLE PROFESSION;
DROP TABLE PULPIT;
DROP TABLE TEACHER;
DROP TABLE SUBJECT;
DROP TABLE GROUPS;
DROP TABLE STUDENT;
DROP TABLE PROGRESS;

ALTER TABLE TEACHER
MODIFY GENDER CHAR(2);

ALTER TABLE SUBJECT
MODIFY TEACHER CHAR(10);

CREATE TABLE FACULTY (
    FACULTY CHAR(10) CONSTRAINT FACULTY_PK PRIMARY KEY,
    FACULTY_NAME VARCHAR2(50) DEFAULT '???'
);

CREATE TABLE PROFESSION (
    PROFESSION CHAR(20) CONSTRAINT PROFESSION_PK PRIMARY KEY,
    FACULTY CHAR(10) CONSTRAINT PROFESSION_FACULTY_FK REFERENCES FACULTY(FACULTY),
    PROFESSION_NAME VARCHAR2(100),
    QUALIFICATION VARCHAR2(50)
);

CREATE TABLE PULPIT (
PULPIT CHAR(20) CONSTRAINT PULPIT_PK PRIMARY KEY,
PULPIT_NAME VARCHAR2(100),
FACULTY CHAR(10) CONSTRAINT PULPIT_FACULTY_FK REFERENCES FACULTY(FACULTY)
);

CREATE TABLE TEACHER (
TEACHER CHAR(10) CONSTRAINT TEACHER_PK PRIMARY KEY,
TEACHER_NAME VARCHAR2(100),
TEACHER_SURNAME VARCHAR2(100),
TEACHER_PATRONYMIC VARCHAR2(100),
GENDER CHAR(2) CHECK (GENDER IN ('М', 'Ж')),
START_DATE DATE NOT NULL,
WORK_TIME DECIMAL(10, 2) NOT NULL,
PULPIT CHAR(20) CONSTRAINT TEACHER_PULPIT_FK REFERENCES PULPIT(PULPIT)
);

CREATE TABLE SUBJECT (
SUBJECT CHAR(10) CONSTRAINT SUBJECT_PK PRIMARY KEY,
SUBJECT_NAME VARCHAR2(100) UNIQUE,
TEACHER CHAR(10) CONSTRAINT SUBJECT_TEACHER_FK REFERENCES TEACHER(TEACHER)
);

CREATE TABLE GROUPS (
IDGROUP NUMBER GENERATED BY DEFAULT AS IDENTITY CONSTRAINT GROUP_PK PRIMARY KEY,
FACULTY CHAR(10) CONSTRAINT GROUPS_FACULTY_FK REFERENCES FACULTY(FACULTY),
PROFESSION CHAR(20) CONSTRAINT GROUPS_PROFESSION_FK REFERENCES PROFESSION(PROFESSION),
YEAR_FIRST SMALLINT CHECK (YEAR_FIRST <= 9999)
);

CREATE TABLE STUDENT (
IDSTUDENT NUMBER GENERATED BY DEFAULT AS IDENTITY CONSTRAINT STUDENT_PK PRIMARY KEY,
IDGROUP NUMBER CONSTRAINT STUDENT_GROUP_FK REFERENCES GROUPS(IDGROUP),
STUDENT_NAME NVARCHAR2(100),
STUDENT_SURNAME VARCHAR2(100),
STUDENT_PATRONYMIC VARCHAR2(100),
BDAY DATE
);

CREATE TABLE PROGRESS (
SUBJECT CHAR(10) CONSTRAINT PROGRESS_SUBJECT_FK REFERENCES SUBJECT(SUBJECT),
IDSTUDENT NUMBER CONSTRAINT PROGRESS_IDSTUDENT_FK REFERENCES STUDENT(IDSTUDENT),
PDATE DATE,
ESTIMATION INTEGER CHECK (ESTIMATION BETWEEN 1 AND 10),
CONSTRAINT PROGRESS_PK PRIMARY KEY (SUBJECT, IDSTUDENT, PDATE)
);

-- Вставка данных в таблицу FACULTY
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F01', 'Факультет гуманитарный');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F02', 'Факультет естественный');
INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES ('F03', 'Факультет математики');

-- Вставка данных в таблицу PROFESSION
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION) VALUES ('P01', 'F01', 'Психология', 'Бакалавр');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION) VALUES ('P02', 'F01', 'Социальная работа', 'Бакалавр');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION) VALUES ('P03', 'F02', 'Биология', 'Бакалавр');
INSERT INTO PROFESSION (PROFESSION, FACULTY, PROFESSION_NAME, QUALIFICATION) VALUES ('P04', 'F03', 'Математика', 'Бакалавр');

-- Вставка данных в таблицу PULPIT
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P01', 'Кафедра психологии', 'F01');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P02', 'Кафедра биологии', 'F02');
INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES ('P03', 'Кафедра математики', 'F03');

-- Вставка данных в таблицу TEACHER
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) VALUES ('T01', 'Иван', 'Иванов', 'Иванович', 'М', TO_DATE('2010-09-01', 'YYYY-MM-DD'), 40.0, 'P01');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) VALUES ('T02', 'Петр', 'Петров', 'Петрович', 'М', TO_DATE('2015-09-01', 'YYYY-MM-DD'), 40.0, 'P02');
INSERT INTO TEACHER (TEACHER, TEACHER_NAME, TEACHER_SURNAME, TEACHER_PATRONYMIC, GENDER, START_DATE, WORK_TIME, PULPIT) VALUES ('T03', 'Сергей', 'Сергеев', 'Сергеевич', 'М', TO_DATE('2018-09-01', 'YYYY-MM-DD'), 40.0, 'P03');

-- Вставка данных в таблицу SUBJECT
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S01', 'Психология развития', 'T01');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S02', 'Экология', 'T02');
INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, TEACHER) VALUES ('S03', 'Алгебра', 'T03');

-- Вставка данных в таблицу GROUPS
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F01', 'P01', 2021);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F02', 'P03', 2022);
INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES ('F03', 'P04', 2023);

-- Вставка данных в таблицу STUDENT
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (1, 'Александр', 'Алексеев', 'Александрович', TO_DATE('2000-05-15', 'YYYY-MM-DD'));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (1, 'Анна', 'Антонова', 'Алексеевна', TO_DATE('2001-10-20', 'YYYY-MM-DD'));
INSERT INTO STUDENT (IDGROUP, STUDENT_NAME, STUDENT_SURNAME, STUDENT_PATRONYMIC, BDAY) VALUES (2, 'Мария', 'Маркова', 'Марковна', TO_DATE('2002-02-05', 'YYYY-MM-DD'));

-- Вставка данных в таблицу PROGRESS
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 1, TO_DATE('2023-06-15', 'YYYY-MM-DD'), 9);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S01', 2, TO_DATE('2023-06-15', 'YYYY-MM-DD'), 8);
INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, ESTIMATION) VALUES ('S02', 3, TO_DATE('2023-06-15', 'YYYY-MM-DD'), 10);