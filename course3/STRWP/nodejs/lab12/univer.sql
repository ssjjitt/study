CREATE DATABASE UNIVER;

USE UNIVER;

-- Удаление таблиц
DROP TABLE IF EXISTS PROGRESS;
DROP TABLE IF EXISTS STUDENT;
DROP TABLE IF EXISTS GROUPS;
DROP TABLE IF EXISTS SUBJECT;
DROP TABLE IF EXISTS TEACHER;
DROP TABLE IF EXISTS PULPIT;
DROP TABLE IF EXISTS PROFESSION;
DROP TABLE IF EXISTS FACULTY;
DROP TABLE IF EXISTS AUDITORIUM;
DROP TABLE IF EXISTS AUDITORIUM_TYPE;

-- Создание и заполнение таблицы AUDITORIUM_TYPE
CREATE TABLE AUDITORIUM_TYPE (
    AUDITORIUM_TYPE CHAR(10) CONSTRAINT AUDITORIUM_TYPE_PK PRIMARY KEY,
    AUDITORIUM_TYPENAME VARCHAR(30)
);

INSERT INTO AUDITORIUM_TYPE (AUDITORIUM_TYPE, AUDITORIUM_TYPENAME) VALUES
('ЛК', 'Лекционная'),
('ЛБ-К', 'Компьютерный класс'),
('ЛК-К', 'Лекционная с уст. проектором'),
('ЛБ-X', 'Химическая лаборатория'),
('ЛБ-СК', 'Спец. компьютерный класс');

-- Создание и заполнение таблицы AUDITORIUM
CREATE TABLE AUDITORIUM (
    AUDITORIUM CHAR(20) CONSTRAINT AUDITORIUM_PK PRIMARY KEY,
    AUDITORIUM_TYPE CHAR(10) CONSTRAINT AUDITORIUM_AUDITORIUM_TYPE_FK FOREIGN KEY REFERENCES AUDITORIUM_TYPE(AUDITORIUM_TYPE),
    AUDITORIUM_CAPACITY INTEGER CONSTRAINT AUDITORIUM_CAPACITY_CHECK DEFAULT 1 CHECK (AUDITORIUM_CAPACITY BETWEEN 1 AND 300),
    AUDITORIUM_NAME VARCHAR(50)
);

INSERT INTO AUDITORIUM (AUDITORIUM, AUDITORIUM_NAME, AUDITORIUM_TYPE, AUDITORIUM_CAPACITY) VALUES
('206-1', '206-1', 'ЛБ-К', 15),
('301-1', '301-1', 'ЛБ-К', 15),
('236-1', '236-1', 'ЛК', 60),
('313-1', '313-1', 'ЛК-К', 60),
('324-1', '324-1', 'ЛК-К', 50),
('413-1', '413-1', 'ЛБ-К', 15),
('423-1', '423-1', 'ЛБ-К', 90),
('408-2', '408-2', 'ЛК', 90);

-- Создание и заполнение таблицы FACULTY
CREATE TABLE FACULTY (
    FACULTY CHAR(10) CONSTRAINT FACULTY_PK PRIMARY KEY,
    FACULTY_NAME VARCHAR(50) DEFAULT '???'
);

INSERT INTO FACULTY (FACULTY, FACULTY_NAME) VALUES
('ХТиТ', 'Химическая технология и техника'),
('ЛХФ', 'Лесохозяйственный факультет'),
('ИЭФ', 'Инженерно-экономический факультет'),
('ТТЛП', 'Технология и техника лесной промышленности'),
('ТОВ', 'Технология органических веществ'),
('ИТ', 'Факультет информационных технологий');

-- Создание и заполнение таблицы PROFESSION
CREATE TABLE PROFESSION (
    PROFESSION CHAR(20) CONSTRAINT PROFESSION_PK PRIMARY KEY,
    FACULTY CHAR(10) CONSTRAINT PROFESSION_FACULTY_FK FOREIGN KEY REFERENCES FACULTY(FACULTY),
    PROFESSION_NAME VARCHAR(100),
    QUALIFICATION VARCHAR(50)
);

INSERT INTO PROFESSION (FACULTY, PROFESSION, PROFESSION_NAME, QUALIFICATION) VALUES
('ИТ', '1-40 01 02', 'Информационные системы и технологии', 'инженер-программист-системотехник'),
('ИТ', '1-47 01 01', 'Издательское дело', 'редактор-технолог'),
('ИТ', '1-36 06 01', 'Полиграфическое оборудование и системы обработки информации', 'инженер-электромеханик'),
('ХТиТ', '1-36 01 08', 'Конструирование и производство изделий из композиционных материалов', 'инженер-механик'),
('ХТиТ', '1-36 07 01', 'Машины и аппараты химических производств и предприятий строительных материалов', 'инженер-механик'),
('ЛХФ', '1-75 01 01', 'Лесное хозяйство', 'инженер лесного хозяйства'),
('ЛХФ', '1-75 02 01', 'Садово-парковое строительство', 'инженер садово-паркового строительства'),
('ЛХФ', '1-89 02 02', 'Туризм и природопользование', 'специалист в сфере туризма'),
('ИЭФ', '1-25 01 07', 'Экономика и управление на предприятии', 'экономист-менеджер'),
('ИЭФ', '1-25 01 08', 'Бухгалтерский учет, анализ и аудит', 'экономист'),
('ТТЛП', '1-36 05 01', 'Машины и оборудование лесного комплекса', 'инженер-механик'),
('ТТЛП', '1-46 01 01', 'Лесоинженерное дело', 'инженер-технолог'),
('ТОВ', '1-48 01 02', 'Химическая технология органических веществ, материалов и изделий', 'инженер-химик-технолог'),
('ТОВ', '1-48 01 05', 'Химическая технология переработки древесины', 'инженер-химик-технолог'),
('ТОВ', '1-54 01 03', 'Физико-химические методы и приборы контроля качества продукции', 'инженер по сертификации');

-- Создание и заполнение таблицы PULPIT
CREATE TABLE PULPIT (
    PULPIT CHAR(20) CONSTRAINT PULPIT_PK PRIMARY KEY,
    PULPIT_NAME VARCHAR(100),
    FACULTY CHAR(10) CONSTRAINT PULPIT_FACULTY_FK FOREIGN KEY REFERENCES FACULTY(FACULTY)
);

INSERT INTO PULPIT (PULPIT, PULPIT_NAME, FACULTY) VALUES
('ИСиТ', 'Информационных систем и технологий', 'ИТ'),
('ЛВ', 'Лесоводства', 'ЛХФ'),
('ЛУ', 'Лесоустройства', 'ЛХФ'),
('ЛЗиДВ', 'Лесозащиты и древесиноведения', 'ЛХФ'),
('ЛКиП', 'Лесных культур и почвоведения', 'ЛХФ'),
('ТиП', 'Туризма и природопользования', 'ЛХФ'),
('ЛПиСПС', 'Ландшафтного проектирования и садово-паркового строительства', 'ЛХФ'),
('ТЛ', 'Транспорта леса', 'ТТЛП'),
('ЛМиЛЗ', 'Лесных машин и технологии лесозаготовок', 'ТТЛП'),
('ТДП', 'Технологий деревообрабатывающих производств', 'ТТЛП'),
('ТиДИД', 'Технологии и дизайна изделий из древесины', 'ТТЛП'),
('ОХ', 'Органической химии', 'ТОВ'),
('ХПД', 'Химической переработки древесины', 'ТОВ'),
('ТНВиОХТ', 'Технологии неорганических веществ и общей химической технологии', 'ХТиТ'),
('ПиАХП', 'Процессов и аппаратов химических производств', 'ХТиТ'),
('ЭТиМ', 'Экономической теории и маркетинга', 'ИЭФ'),
('МиЭП', 'Менеджмента и экономики природопользования', 'ИЭФ'),
('СБУАиА', 'Статистики, бухгалтерского учета, анализа и аудита', 'ИЭФ');

-- Создание и заполнение таблицы TEACHER
CREATE TABLE TEACHER (
    TEACHER CHAR(10) CONSTRAINT TEACHER_PK PRIMARY KEY,
    TEACHER_NAME VARCHAR(100),
    GENDER CHAR(1) CHECK (GENDER IN ('м', 'ж')),
    PULPIT CHAR(20) CONSTRAINT TEACHER_PULPIT_FK FOREIGN KEY REFERENCES PULPIT(PULPIT)
);

INSERT INTO TEACHER (TEACHER, TEACHER_NAME, GENDER, PULPIT) VALUES
('СМЛВ', 'Смелов Владимир Владиславович', 'м', 'ИСиТ'),
('ДТК', 'Дятко Александр Аркадьевич', 'м', 'ИСиТ'),
('УРБ', 'Урбанович Павел Павлович', 'м', 'ИСиТ'),
('ГРН', 'Гурин Николай Иванович', 'м', 'ИСиТ'),
('ЖЛК', 'Жиляк Надежда Александровна', 'ж', 'ИСиТ'),
('МРЗ', 'Мороз Елена Станиславовна', 'ж', 'ИСиТ'),
('НВРВ', 'Неверов Александр Васильевич', 'м', 'МиЭП'),
('РВКЧ', 'Ровкач Андрей Иванович', 'м', 'ЛВ'),
('ДМДК', 'Демидко Марина Николаевна', 'ж', 'ЛПиСПС'),
('БРГ', 'Бурганская Татьяна Минаевна', 'ж', 'ЛПиСПС'),
('РЖК', 'Рожков Леонид Николаевич', 'м', 'ЛВ'),
('ЗВГЦВ', 'Звягинцев Вячеслав Борисович', 'м', 'ЛЗиДВ'),
('БЗБРДВ', 'Безбородов Владимир Степанович', 'м', 'ОХ'),
('НСКВЦ', 'Насковец Михаил Трофимович', 'м', 'ТЛ');

-- Создание и заполнение таблицы SUBJECT
CREATE TABLE SUBJECT (
    SUBJECT CHAR(10) CONSTRAINT SUBJECT_PK PRIMARY KEY,
    SUBJECT_NAME VARCHAR(100) UNIQUE,
    PULPIT CHAR(20) CONSTRAINT SUBJECT_PULPIT_FK FOREIGN KEY REFERENCES PULPIT(PULPIT)
);

INSERT INTO SUBJECT (SUBJECT, SUBJECT_NAME, PULPIT) VALUES
('СУБД', 'Системы управления базами данных', 'ИСиТ'),
('БД', 'Базы данных', 'ИСиТ'),
('ИНФ', 'Информационные технологии', 'ИСиТ'),
('ОАиП', 'Основы алгоритмизации и программирования', 'ИСиТ'),
('ПЗ', 'Представление знаний в компьютерных системах', 'ИСиТ'),
('ПСП', 'Программирование сетевых приложений', 'ИСиТ'),
('МСОИ', 'Моделирование систем обработки информации', 'ИСиТ'),
('ПИС', 'Проектирование информационных систем', 'ИСиТ'),
('КГ', 'Компьютерная геометрия', 'ИСиТ'),
('КМС', 'Компьютерные мультимедийные системы', 'ИСиТ'),
('ДМ', 'Дискретная математика', 'ИСиТ'),
('МП', 'Математическое программирование', 'ИСиТ'),
('ЛЭВМ', 'Логические основы ЭВМ', 'ИСиТ'),
('ООП', 'Объектно-ориентированное программирование', 'ИСиТ'),
('ЭП', 'Экономика природопользования', 'МиЭП'),
('ЭТ', 'Экономическая теория', 'ЭТиМ'),
('ОСПиЛПХ', 'Основы садово-паркового и лесопаркового хозяйства', 'ЛПиСПС'),
('ИГ', 'Инженерная геодезия', 'ЛУ'),
('ЛВ', 'Лесоводство', 'ЛЗиДВ'),
('ОХ', 'Органическая химия', 'ОХ'),
('ВТЛ', 'Водный транспорт леса', 'ТЛ')
-- Создание и заполнение таблицы GROUPS
CREATE TABLE GROUPS (
    IDGROUP INTEGER IDENTITY(1,1) CONSTRAINT GROUP_PK PRIMARY KEY,
    FACULTY CHAR(10) CONSTRAINT GROUPS_FACULTY_FK FOREIGN KEY REFERENCES FACULTY(FACULTY),
    PROFESSION CHAR(20) CONSTRAINT GROUPS_PROFESSION_FK FOREIGN KEY REFERENCES PROFESSION(PROFESSION),
    YEAR_FIRST SMALLINT CHECK (YEAR_FIRST <= YEAR(GETDATE()))
);

INSERT INTO GROUPS (FACULTY, PROFESSION, YEAR_FIRST) VALUES
('ИТ', '1-40 01 02', 2013),
('ИТ', '1-40 01 02', 2012),
('ИТ', '1-47 01 01', 2011),
('ИТ', '1-47 01 01', 2010),
('ХТиТ', '1-36 01 08', 2013),
('ХТиТ', '1-36 01 08', 2012),
('ХТиТ', '1-36 07 01', 2011),
('ХТиТ', '1-36 07 01', 2010),
('ТОВ', '1-48 01 02', 2012),
('ТОВ', '1-48 01 02', 2011),
('ТОВ', '1-48 01 05', 2013),
('ТОВ', '1-54 01 03', 2012),
('ЛХФ', '1-75 01 01', 2013),
('ЛХФ', '1-75 02 01', 2012),
('ЛХФ', '1-75 02 01', 2011),
('ЛХФ', '1-89 02 02', 2012),
('ЛХФ', '1-89 02 02', 2011)

-- Создание и заполнение таблицы STUDENT
CREATE TABLE STUDENT (
    IDSTUDENT INTEGER IDENTITY(1000,1) CONSTRAINT STUDENT_PK PRIMARY KEY,
    IDGROUP INTEGER CONSTRAINT STUDENT_GROUP_FK FOREIGN KEY REFERENCES GROUPS(IDGROUP),
    NAME NVARCHAR(100),
    BDAY DATE,
    STAMP TIMESTAMP,
    INFO XML,
    FOTO VARBINARY
);

SELECT * FROM GROUPS

INSERT INTO STUDENT (IDGROUP, NAME, BDAY) VALUES
(3, 'Силюк Валерия Ивановна', '12.07.1994'),
(3, 'Сергель Виолетта Николаевна', '06.03.1994'),
(3, 'Добродей Ольга Анатольевна', '09.11.1994'),
(3, 'Подоляк Мария Сергеевна', '04.10.1994'),
(3, 'Никитенко Екатерина Дмитриевна', '08.01.1994'),
(4, 'Яцкевич Галина Иосифовна', '02.08.1993'),
(4, 'Осадчая Эла Васильевна', '07.12.1993'),
(4, 'Акулова Елена Геннадьевна', '02.12.1993'),
(4, 'Плешкун Милана Анатольевна', '08.03.1992'),
(4, 'Буянова Мария Александровна', '02.06.1992'),
(4, 'Харченко Елена Геннадьевна', '11.12.1992'),
(4, 'Крученок Евгений Александрович', '11.05.1992'),
(4, 'Бороховский Виталий Петрович', '09.11.1992'),
(4, 'Мацкевич Надежда Валерьевна', '01.11.1992'),
(5, 'Логинова Мария Вячеславовна', '08.07.1995'),
(5, 'Белько Наталья Николаевна', '02.11.1995'),
(5, 'Селило Екатерина Геннадьевна', '07.05.1995'),
(5, 'Дрозд Анастасия Андреевна', '04.08.1995'),
(6, 'Козловская Елена Евгеньевна', '08.11.1994'),
(6, 'Потапнин Кирилл Олегович', '02.03.1994'),
(6, 'Равковская Ольга Николаевна', '04.06.1994'),
(6, 'Ходоронок Александра Вадимовна', '09.11.1994'),
(6, 'Рамук Владислав Юрьевич', '04.07.1994'),
(7, 'Неруганенок Мария Владимировна', '03.01.1993'),
(7, 'Цыганок Анна Петровна', '12.09.1993'),
(7, 'Масилевич Оксана Игоревна', '12.06.1993'),
(7, 'Алексиевич Елизавета Викторовна', '09.02.1993'),
(7, 'Ватолин Максим Андреевич', '04.07.1993'),
(8, 'Синица Валерия Андреевна', '08.01.1992'),
(8, 'Кудряшова Алина Николаевна', '12.05.1992'),
(8, 'Мигулина Елена Леонидовна', '08.11.1992'),
(8, 'Шпиленя Алексей Сергеевич', '12.03.1992'),
(9, 'Астафьев Игорь Александрович', '10.08.1995'),
(9, 'Гайтюкевич Андрей Игоревич', '02.05.1995'),
(9, 'Рученя Наталья Александровна', '08.01.1995'),
(9, 'Тарасевич Анастасия Ивановна', '11.09.1995'),
(10, 'Жоглин Николай Владимирович', '08.01.1994'),
(10, 'Санько Андрей Дмитриевич', '11.09.1994'),
(10, 'Пещур Анна Александровна', '06.04.1994'),
(10, 'Бучалис Никита Леонидович', '12.08.1994');

-- Создание и заполнение таблицы PROGRESS
CREATE TABLE PROGRESS (
    SUBJECT CHAR(10) CONSTRAINT PROGRESS_SUBJECT_FK FOREIGN KEY REFERENCES SUBJECT(SUBJECT),
    IDSTUDENT INTEGER CONSTRAINT PROGRESS_IDSTUDENT_FK FOREIGN KEY REFERENCES STUDENT(IDSTUDENT),
    PDATE DATE,
    NOTE INTEGER CHECK (NOTE BETWEEN 1 AND 10)
);

INSERT INTO PROGRESS (SUBJECT, IDSTUDENT, PDATE, NOTE) VALUES
('ОАиП', 1001, '01.10.2013', 8),
('ОАиП', 1002, '01.10.2013', 7),
('ОАиП', 1003, '01.10.2013', 5),
('ОАиП', 1005, '01.10.2013', 4),
('СУБД', 1014, '01.12.2013', 5),
('СУБД', 1015, '01.12.2013', 9),
('СУБД', 1016, '01.12.2013', 5),
('СУБД', 1017, '01.12.2013', 4),
('КГ', 1018, '06.05.2013', 4),
('КГ', 1019, '06.05.2013', 7),
('КГ', 1020, '06.05.2013', 7),
('КГ', 1021, '06.05.2013', 9),
('КГ', 1022, '06.05.2013', 5),
('КГ', 1023, '06.05.2013', 6);
